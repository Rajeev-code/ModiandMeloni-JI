<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Flappy Bird (Responsive)</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: linear-gradient(to bottom, #70c5ce, #ffffff);
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    touch-action: none;
  }

  canvas {
    display: block;
    border: 3px solid #000;
    border-radius: 10px;
    background: #70c5ce;
    width: 95vw;
    height: auto;
    max-height: 90vh;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>

<!-- ðŸŽµ Sounds -->
<audio id="bgMusic" src="music.mp3" loop></audio>
<audio id="hitSound" src="hit.mp3"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const music = document.getElementById("bgMusic");
const hitSound = document.getElementById("hitSound");

// ðŸ§© Dynamic resizing (keeps aspect ratio)
function resizeCanvas() {
  const ratio = 16 / 9;
  let w = window.innerWidth * 0.95;
  let h = w / ratio;

  if (h > window.innerHeight * 0.9) {
    h = window.innerHeight * 0.9;
    w = h * ratio;
  }

  canvas.width = w;
  canvas.height = h;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// ðŸ–¼ï¸ Load images
const birdImg = new Image(); birdImg.src = "bird.png";
const pipeImg = new Image(); pipeImg.src = "pipe.png";
const bgImg = new Image(); bgImg.src = "bg.png";

// ðŸ¤ Bird setup
let bird = {
  x: 60,
  y: canvas.height / 2,
  width: canvas.width * 0.08,
  height: canvas.height * 0.06,
  gravity: 0.4,
  lift: -6,
  velocity: 0
};

// ðŸ§± Pipes
let pipes = [];
let frame = 0;
let score = 0;
let gameOver = false;

// ðŸŽ® Controls
function flap() {
  if (!gameOver) {
    bird.velocity = bird.lift;
  } else {
    resetGame();
  }
  if (music.paused) music.play();
}

document.addEventListener("keydown", e => { if (e.code === "Space") flap(); });
canvas.addEventListener("mousedown", flap);
canvas.addEventListener("touchstart", e => {
  e.preventDefault();
  flap();
});

// ðŸŒ„ Background
function drawBackground() {
  ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);
}

// ðŸ¤ Bird
function drawBird() {
  ctx.drawImage(birdImg, bird.x - bird.width / 2, bird.y - bird.height / 2, bird.width, bird.height);
}

// ðŸ§± Pipes
function drawPipes() {
  pipes.forEach(pipe => {
    // Top pipe
    ctx.save();
    ctx.translate(pipe.x + pipe.width, pipe.top);
    ctx.scale(-1, -1);
    ctx.drawImage(pipeImg, 0, 0, pipe.width, canvas.height - pipe.bottom);
    ctx.restore();

    // Bottom pipe
    const pipeHeight = canvas.height - pipe.bottom;
    ctx.drawImage(pipeImg, pipe.x, pipe.bottom, pipe.width, pipeHeight);
  });
}

// ðŸŒ€ Update pipes
function updatePipes() {
  if (frame % 100 === 0) {
    let top = Math.random() * (canvas.height / 3);
    let gap = canvas.height * 0.25;
    pipes.push({
      x: canvas.width,
      width: canvas.width * 0.15,
      top: top,
      bottom: top + gap
    });
  }

  pipes.forEach(pipe => {
    pipe.x -= canvas.width * 0.0045;

    if (
      bird.x + bird.width / 2 > pipe.x &&
      bird.x - bird.width / 2 < pipe.x + pipe.width &&
      (bird.y - bird.height / 2 < pipe.top || bird.y + bird.height / 2 > pipe.bottom)
    ) {
      if (!gameOver) hitSound.play();
      gameOver = true;
      music.pause();
    }

    if (pipe.x + pipe.width === Math.round(bird.x)) score++;
  });

  if (pipes.length && pipes[0].x < -pipes[0].width) pipes.shift();
}

// ðŸ§® Score & FPS
let fps = 0, lastTime = performance.now(), frames = 0;
function drawScoreAndFPS() {
  ctx.fillStyle = "black";
  ctx.font = `${canvas.width * 0.06}px Arial`;
  ctx.fillText("Score: " + score, 10, canvas.width * 0.08);

  const now = performance.now();
  frames++;
  if (now - lastTime >= 1000) {
    fps = frames;
    frames = 0;
    lastTime = now;
  }
  ctx.font = `${canvas.width * 0.04}px Arial`;
  ctx.fillText(`FPS: ${fps}`, canvas.width - 100, 30);
}

// ðŸ•Šï¸ Update bird
function updateBird() {
  bird.velocity += bird.gravity * 0.25;
  bird.y += bird.velocity;

  if (bird.y + bird.height / 2 > canvas.height || bird.y - bird.height / 2 < 0) {
    if (!gameOver) hitSound.play();
    gameOver = true;
    music.pause();
  }
}

// ðŸ’€ Game Over
function drawGameOver() {
  ctx.fillStyle = "rgba(0,0,0,0.6)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "white";
  ctx.textAlign = "center";
  ctx.font = `${canvas.width * 0.1}px Arial`;
  ctx.fillText("Game Over!", canvas.width / 2, canvas.height / 2 - 20);
  ctx.font = `${canvas.width * 0.06}px Arial`;
  ctx.fillText(`Score: ${score}`, canvas.width / 2, canvas.height / 2 + 40);
  ctx.fillText("Tap to Restart", canvas.width / 2, canvas.height / 2 + 90);
}

// ðŸ”„ Reset
function resetGame() {
  bird.y = canvas.height / 2;
  bird.velocity = 0;
  pipes = [];
  frame = 0;
  score = 0;
  gameOver = false;
  music.play();
}

// ðŸ•¹ï¸ Main loop
function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBackground();

  if (gameOver) {
    drawGameOver();
  } else {
    drawBird();
    drawPipes();
    drawScoreAndFPS();
    updateBird();
    updatePipes();
    frame++;
  }

  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
  </html>
